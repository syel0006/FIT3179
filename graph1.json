{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Migration outcomes by stream over time",
  "data": {
    "url": "https://raw.githubusercontent.com/syel0006/FIT3179/refs/heads/main/migration_outcome_byStream",
    "format": {"type": "csv"}
  },
  "transform": [
  {
    "fold": [
      "Family stream1",
      "Child visa2",
      "Skill stream",
      "Special Eligibility",
      "Total"
    ],
    "as": ["Stream", "CountRaw"]
  },
  { "calculate": "replace(datum.CountRaw, ',', '')", "as": "CountNoComma" },
  { "calculate": "toNumber(datum.CountNoComma)", "as": "Count" },
  { "calculate": "toNumber(substring(datum.Year, 0, 4))", "as": "YearStart" },
  {
  "filter": "(datum.Stream == 'Skill stream' && pSkill) || (datum.Stream == 'Family stream1' && pFamily) || (datum.Stream == 'Child visa2' && pChild) || (datum.Stream == 'Special Eligibility' && pSpec) || (datum.Stream == 'Total' && pTotal)"
}
],

  "params": [
  { "name": "pSkill",  "value": true, "bind": { "input": "checkbox", "name": " Skill stream " } },
  { "name": "pFamily", "value": true, "bind": { "input": "checkbox", "name": " Family stream " } },
  { "name": "pChild",  "value": true, "bind": { "input": "checkbox", "name": " Child visa " } },
  { "name": "pSpec",   "value": true, "bind": { "input": "checkbox", "name": " Special Eligibility " } },
  { "name": "pTotal",   "value": true, "bind": { "input": "checkbox", "name": " Total " } }

],

  "mark": {"type": "line", "point": true},
  
  "encoding": {
  "x": {
    "field": "Year",
    "type": "ordinal",
    "title": "Financial Year",
    "axis": {
      "labelAngle": -45,
      "labelFontSize": 10,
      "title": "Financial year",
      "labelOverlap": false
    }
  },
  "y": {
    "field": "Count",
    "type": "quantitative",
    "title": "Number of Migrants",
    "axis": {"format": "~s"},
    "scale": {"domain": [0,200000]}
  },
  "color": {
  "field": "Stream",
  "type": "nominal",
  "title": "Stream",
  "scale": {
    "domain": [
      "Skill stream",
      "Family stream1",
      "Child visa2",
      "Special Eligibility",
      "Total"
    ],
    "range": [
      "#F0670C",  
      "#28a745",  
      "#ffc107",  
      "#190996", 
      "black"
    ]
  }
} 

  ,"tooltip": [
    {"field": "Year", "type": "nominal", "title": "Financial Year"},
    {"field": "Stream", "type": "nominal"},
    {"field": "Count", "type": "quantitative", "title": "Count", "format":","}
  ]
}

}
